(this["webpackJsonpgolf-gamblers-front-end"]=this["webpackJsonpgolf-gamblers-front-end"]||[]).push([[0],{28:function(e){e.exports=JSON.parse('{"subscription_prices_keys":{"basic":"price_1IRogLJgYHulMnJqhsDpckaT"},"subscription_product_key":{"basic":"prod_J3wZChslCkhQrI"},"publishableKey":"pk_live_51IRo7cJgYHulMnJqhlqht9joA1aDyACvpIeihyPWZKohmMbFCy74bFyrOvCNwLCf2clQJ0CAaiHVnmpalhctLIiR00n4hOXCTv"}')},48:function(e){e.exports=JSON.parse('{"apiKey":"AIzaSyBGWMEAFhrI37uH1NpQFZGVxF8LWuT2XA0","authDomain":"golf-gamblers.firebaseapp.com","projectId":"golf-gamblers","storageBucket":"golf-gamblers.appspot.com","messagingSenderId":"537485515557","appId":"1:537485515557:web:621eff503cd374fa3d58cc","measurementId":"G-DYSPGQCB9M"}')},59:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var c=n(1),i=n.n(c),r=n(27),o=n.n(r),s=(n(59),n(41)),a=n(6),u=n(32),l=n(8),d=n(24),b=n.n(d),j=n(33),h=n(23),f=n(5),p=(n(40),n(44),n(79),n(48)),v=n(28),O=n(3),g=f.a.apps.length?f.a.app():f.a.initializeApp(p),x=g.firestore(),m=g.auth();m.setPersistence(f.a.auth.Auth.Persistence.LOCAL);var w=g.functions("us-central1"),k=[],S=Object(c.createContext)(null),C=Object(c.createContext)(void 0);function y(e){var t=Object(c.useState)(null),n=Object(h.a)(t,2),i=n[0],r=n[1],o=Object(c.useState)(void 0),s=Object(h.a)(o,2),a=s[0],u=s[1];return Object(c.useEffect)((function(){m.onAuthStateChanged((function(e){if(e){var t=x.collection("customers").doc(e.uid).collection("subscriptions").onSnapshot((function(e){e.forEach((function(e){e.data().product.get(v.subscription_product_key.basic)&&u({subscriptionLevel:"basic"})}))}));k.push(t)}else u(void 0);r(e)}))}),[]),Object(O.jsx)(S.Provider,{value:i,children:Object(O.jsx)(C.Provider,{value:a,children:e.children})})}function I(){return Object(c.useContext)(S)}function A(){for(var e=0;e<k.length;e++){(0,k[e])()}k=[]}function _(e){return P.apply(this,arguments)}function P(){return(P=Object(j.a)(b.a.mark((function e(t){var n,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.httpsCallable("ext-firestore-stripe-subscriptions-createPortalLink"),e.next=3,n({returnUrl:window.location.origin});case 3:return c=e.sent,i=c.data,window.location.assign(i.url),e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}f.a.auth.EmailAuthProvider.PROVIDER_ID;var L=n(37),W=n(94),E=n(95);function D(){var e=I(),t=x,n=Object(L.useStripe)(),i=w,r=Object(c.useContext)(C),o=Object(c.useState)(!1),s=Object(h.a)(o,2),a=s[0],u=s[1],l=Object(c.useState)(!1),d=Object(h.a)(l,2),f=d[0],p=d[1];var g=function(){var c=Object(j.a)(b.a.mark((function c(){return b.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!e){c.next=6;break}return p(!0),c.next=4,t.collection("customers").doc(e.uid).collection("checkout_sessions").add({price:v.subscription_prices_keys.basic,success_url:window.location.origin,cancel_url:window.location.origin});case 4:c.sent.onSnapshot((function(e){var t=e.data();if(t){var c=t.error,i=t.sessionId;c&&alert("An error occured: "+c.message),i&&n&&(n.redirectToCheckout({sessionId:i}),p(!1))}}));case 6:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}(),k=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,_(i);case 3:u(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"Account Information"}),Object(O.jsxs)("div",{children:["Email: ",null===e||void 0===e?void 0:e.email]}),Object(O.jsxs)("div",{children:["Name: ",null===e||void 0===e?void 0:e.displayName]})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"Subscription Status"}),Object(O.jsxs)("div",{children:["Subscription State: ",r?r.subscriptionLevel:"Not subscribed"]}),r?Object(O.jsxs)("div",{children:[Object(O.jsx)(E.a,{onClick:k,children:"Manage Subscriptions"}),a?Object(O.jsx)(W.a,{}):Object(O.jsx)("div",{})]}):Object(O.jsxs)("div",{children:[Object(O.jsx)(E.a,{onClick:g,children:"Subscribe"}),f?Object(O.jsx)(W.a,{}):Object(O.jsx)("div",{})]})]}),Object(O.jsx)("div",{children:Object(O.jsx)(E.a,{onClick:function(){A(),m.signOut()},children:"Logout"})}),Object(O.jsx)("div",{children:Object(O.jsx)(E.a,{onClick:function(){e&&function(e){A(),e.delete().then((function(){return console.log("Successfully deleted account")})).catch((function(e){return console.error(e)}))}(e)},color:"secondary",children:"Delete Account"})})]})}var F=n(50),J=n.n(F);function N(){var e=Object(l.g)(),t=m,n=I(),c={signInFlow:"popup",signInOptions:[f.a.auth.EmailAuthProvider.PROVIDER_ID],callbacks:{signInSuccessWithAuthResult:function(){return!1}}},i=void 0;if(e&&e.location&&e.location.state){var r=e.location.state;r&&r.from&&r.from.pathname&&(i=r.from.pathname)}return n?i&&"/login"!==i?Object(O.jsx)(l.a,{to:i}):Object(O.jsx)(l.a,{to:"/"}):Object(O.jsx)("div",{id:"firebaseui-auth-container",children:Object(O.jsx)(J.a,{uiConfig:c,firebaseAuth:t})})}function R(){var e=I();return Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{children:["Welcome ",null===e||void 0===e?void 0:e.displayName," !"]}),Object(O.jsx)("div",{children:Object(O.jsx)(u.b,{to:"/account",children:"Account"})})]})}function T(){return Object(O.jsx)(u.a,{children:Object(O.jsxs)(l.d,{children:[Object(O.jsx)(l.b,{path:"/login",children:Object(O.jsx)(N,{})}),Object(O.jsx)(M,{path:"/account",children:Object(O.jsx)(D,{})}),Object(O.jsx)(M,{path:"/",children:Object(O.jsx)(R,{})}),Object(O.jsx)(M,{path:"*",children:Object(O.jsx)(l.a,{to:"/"})})]})})}function M(e){var t=e.children,n=Object(a.a)(e,["children"]),c=I();return Object(O.jsx)(l.b,Object(s.a)(Object(s.a)({},n),{},{render:function(e){var n=e.location;return c?t:Object(O.jsx)(l.a,{to:{pathname:"/login",state:{from:n}}})}}))}var B=n(52),G=Object(B.a)(v.publishableKey);var H=function(){return Object(O.jsx)(y,{children:Object(O.jsx)(L.Elements,{stripe:G,children:Object(O.jsx)(T,{})})})},K=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Q(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,96)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),i(e),r(e),o(e)}))};o.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(H,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");K?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Q(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Q(t,e)}))}}(),U()}},[[78,1,2]]]);
//# sourceMappingURL=main.e4622a6c.chunk.js.map
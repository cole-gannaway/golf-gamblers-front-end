(this["webpackJsonpgolf-gamblers-front-end"]=this["webpackJsonpgolf-gamblers-front-end"]||[]).push([[0],{28:function(e){e.exports=JSON.parse('{"subscription_prices_keys":{"basic":"price_1IRogLJgYHulMnJqhsDpckaT"},"subscription_product_key":{"basic":"prod_J3wZChslCkhQrI"},"publishableKey":"pk_live_51IRo7cJgYHulMnJqhlqht9joA1aDyACvpIeihyPWZKohmMbFCy74bFyrOvCNwLCf2clQJ0CAaiHVnmpalhctLIiR00n4hOXCTv"}')},48:function(e){e.exports=JSON.parse('{"apiKey":"AIzaSyBGWMEAFhrI37uH1NpQFZGVxF8LWuT2XA0","authDomain":"golf-gamblers.firebaseapp.com","projectId":"golf-gamblers","storageBucket":"golf-gamblers.appspot.com","messagingSenderId":"537485515557","appId":"1:537485515557:web:621eff503cd374fa3d58cc","measurementId":"G-DYSPGQCB9M"}')},59:function(e,n,t){},78:function(e,n,t){"use strict";t.r(n);var c=t(1),i=t.n(c),r=t(27),o=t.n(r),s=(t(59),t(41)),a=t(6),u=t(32),l=t(8),d=t(24),b=t.n(d),j=t(33),h=t(23),p=t(5),f=(t(40),t(44),t(79),t(48)),v=t(28),O=t(3),g=p.a.apps.length?p.a.app():p.a.initializeApp(f),x=g.firestore(),w=g.auth();w.setPersistence(p.a.auth.Auth.Persistence.LOCAL);var m=g.functions("us-central1"),k=void 0,S=Object(c.createContext)(null),C=Object(c.createContext)(void 0);function y(e){var n=Object(c.useState)(null),t=Object(h.a)(n,2),i=t[0],r=t[1],o=Object(c.useState)(void 0),s=Object(h.a)(o,2),a=s[0],u=s[1];return Object(c.useEffect)((function(){w.onAuthStateChanged((function(e){e?k=x.collection("customers").doc(e.uid).collection("subscriptions").onSnapshot((function(e){e.forEach((function(e){e.data().product.get(v.subscription_product_key.basic)&&u({subscriptionLevel:"basic"})}))})):u(void 0),r(e)}))}),[]),Object(O.jsx)(S.Provider,{value:i,children:Object(O.jsx)(C.Provider,{value:a,children:e.children})})}function I(){return Object(c.useContext)(S)}function A(){k&&(k(),k=void 0)}function _(e){return P.apply(this,arguments)}function P(){return(P=Object(j.a)(b.a.mark((function e(n){var t,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.httpsCallable("ext-firestore-stripe-subscriptions-createPortalLink"),e.next=3,t({returnUrl:window.location.origin});case 3:return c=e.sent,i=c.data,window.location.assign(i.url),e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}p.a.auth.EmailAuthProvider.PROVIDER_ID;var L=t(37),W=t(94),E=t(95);function D(){var e=I(),n=x,t=Object(L.useStripe)(),i=m,r=Object(c.useContext)(C),o=Object(c.useState)(!1),s=Object(h.a)(o,2),a=s[0],u=s[1],l=Object(c.useState)(!1),d=Object(h.a)(l,2),p=d[0],f=d[1];var g=function(){var c=Object(j.a)(b.a.mark((function c(){return b.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!e){c.next=6;break}return f(!0),c.next=4,n.collection("customers").doc(e.uid).collection("checkout_sessions").add({price:v.subscription_prices_keys.basic,success_url:window.location.origin,cancel_url:window.location.origin});case 4:c.sent.onSnapshot((function(e){var n=e.data();if(n){var c=n.error,i=n.sessionId;c&&alert("An error occured: "+c.message),i&&t&&(t.redirectToCheckout({sessionId:i}),f(!1))}}));case 6:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}(),k=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,_(i);case 3:u(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"Account Information"}),Object(O.jsxs)("div",{children:["Email: ",null===e||void 0===e?void 0:e.email]}),Object(O.jsxs)("div",{children:["Name: ",null===e||void 0===e?void 0:e.displayName]})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"Subscription Status"}),Object(O.jsxs)("div",{children:["Subscription State: ",r?r.subscriptionLevel:"Not subscribed"]}),r?Object(O.jsxs)("div",{children:[Object(O.jsx)(E.a,{onClick:k,children:"Manage Subscriptions"}),a?Object(O.jsx)(W.a,{}):Object(O.jsx)("div",{})]}):Object(O.jsxs)("div",{children:[Object(O.jsx)(E.a,{onClick:g,children:"Subscribe"}),p?Object(O.jsx)(W.a,{}):Object(O.jsx)("div",{})]})]}),Object(O.jsx)("div",{children:Object(O.jsx)(E.a,{onClick:function(){A(),w.signOut()},children:"Logout"})}),Object(O.jsx)("div",{children:Object(O.jsx)(E.a,{onClick:function(){e&&function(e){A(),e.delete().then((function(){return console.log("Successfully deleted account")})).catch((function(e){return console.error(e)}))}(e)},color:"secondary",children:"Delete Account"})})]})}var F=t(50),J=t.n(F);function N(){var e=w,n=I(),t={signInFlow:"popup",signInOptions:[p.a.auth.EmailAuthProvider.PROVIDER_ID],callbacks:{signInSuccessWithAuthResult:function(){return!1}}};return n?Object(O.jsx)(l.a,{to:"/"}):Object(O.jsx)("div",{children:Object(O.jsx)(J.a,{uiConfig:t,firebaseAuth:e})})}function R(){var e=I();return Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{children:["Welcome ",null===e||void 0===e?void 0:e.displayName," !"]}),Object(O.jsx)("div",{children:Object(O.jsx)(u.b,{to:"/account",children:"Account"})})]})}function T(){return Object(O.jsx)(u.a,{children:Object(O.jsxs)(l.d,{children:[Object(O.jsx)(l.b,{path:"/login",children:Object(O.jsx)(N,{})}),Object(O.jsx)(M,{path:"/account",children:Object(O.jsx)(D,{})}),Object(O.jsx)(M,{path:"/",children:Object(O.jsx)(R,{})})]})})}function M(e){var n=e.children,t=Object(a.a)(e,["children"]),c=I();return Object(O.jsx)(l.b,Object(s.a)(Object(s.a)({},t),{},{render:function(e){var t=e.location;return c?n:Object(O.jsx)(l.a,{to:{pathname:"/login",state:{from:t}}})}}))}var B=t(52),G=Object(B.a)(v.publishableKey);var H=function(){return Object(O.jsx)(y,{children:Object(O.jsx)(L.Elements,{stripe:G,children:Object(O.jsx)(T,{})})})},K=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Q(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var U=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,96)).then((function(n){var t=n.getCLS,c=n.getFID,i=n.getFCP,r=n.getLCP,o=n.getTTFB;t(e),c(e),i(e),r(e),o(e)}))};o.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(H,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");K?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var c=t.headers.get("content-type");404===t.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Q(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Q(n,e)}))}}(),U()}},[[78,1,2]]]);
//# sourceMappingURL=main.a5789edd.chunk.js.map